---
layout: fexo
title: "重构手法之使用卫语句移除嵌套条件语句"
date: 2019-10-07T08:18:25.000Z
tags: null
permalink: 2019-10-07-refactoring-nested-condition-statement
---

## 手法

使用提早退出循环的方式来移除多重嵌套的条件语句

## 例子

例子一:二叉树查找节点

```js
BST.prototype.findRecursively = function(value) {
  return findRecursively(this.root, value);
  function findRecursively(node, value) {
    if (value !== node.value) {
      if (!node.left && !node.right) {
        return -1;
      } else {
        if (value < node.value) {
          return findRecursively(node.left, value);
        } else {
          return findRecursively(node.right, value);
        }
      }
    } else {
      return node;
    }
  }
};
```

重构后

```js
BST.prototype.findRecursively = function(value) {
  return findRecursively(this.root, value);
  function findRecursively(node, value) {
    if (value === node.value) return node;
    if (!node.left && !node.right) return -1;
    if (value < node.value) {
      return findRecursively(node.left, value);
    } else {
      return findRecursively(node.right, value);
    }
  }
};
```

例子二: leetcode 290, word patterns

```js
var wordPattern = function(pattern, str) {
  let map = Object.create(null);
  let seenSet = new Set();
  let strList = str.split(" ");
  if (pattern.length !== strList.length) return false;
  for (let i = 0; i < pattern.length; i++) {
    let p = pattern[i];
    let s = strList[i];
    if (map[p] && map[p] !== s) {
      return false;
    }
    if (!map[p]) {
      if (seenSet.has(s)) {
        map[p] = s;
        seenSet.add(s);
      } else {
        return false;
      }
    }
  }
  return true;
};
```

重构后

```js
var wordPattern = function(pattern, str) {
  let map = Object.create(null);
  let seenSet = new Set();
  let strList = str.split(" ");
  if (pattern.length !== strList.length) return false;
  for (let i = 0; i < pattern.length; i++) {
    let p = pattern[i];
    let s = strList[i];
    if (map[p] && map[p] !== s) return false;
    if (!map[p] && seenSet.has(s)) return false;
    map[p] = s;
    seenSet.add(s);
  }
  return true;
};
```
