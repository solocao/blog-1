---
title: '实现angluar手记[零]项目初始化'
date: 2019-07-11
tags:
  - angular
permalink: 2019-07-11-build-your-own-angular-0-project-setup
---

## 前言

### 2019.07.13

去年看过部分《build-your-own-angular》, 收获多多, 现在二刷希望有更好的理解, 现在是 2019 年, angular 份额显然不如 vue, react, jquery 宣布退出历史舞台, 是否还有必要看这一本书, 我的想法是: 框架是会过时的, jquery 会, vue 和 react 也会, 唯有框架内在的东西不会过时, 掌握内核才能让自己成为一个更好的工程师.

### 2020.07.20

一年的时间就这么过去了, 打算又把本书完整地敲一遍, 重读的原因有以下

1. 上次重读实际上没有完成任务, 后半部分是没有搞定的,希望自己不要半途而废
2. 之前参加过 TDD 实战训练营, 但是只是简单的知道 TDD 这个东西, 要想真正掌握一定离不开持续的实践总结, **该如何设计, 测试用例如何编写, 如何用测试驱动实现?**, 这本书无疑是一种很好的参考, 后续会试试用 tdd 写一个简单的 vue

## 配置(新)

### 系统 mac

- 代码格式化: eslint + prettier + vscode
- 测试: jest + puppeteer
- es6+ 语法: babel 编译, 去掉旧项目中的一些依赖如 Lodash

配置参考在这 👉 个[仓库](https://github.com/chenxiaoyao6228/js-jest-eslint-husky-starter.git)下, 有需要可以去看看

## 配置(旧)

为了避免一些无意义的踩坑 v, 这里记录下项目初始化的一些情况, 自动化工具一茬又一茬, grunt, gulp, webpack, parcel, 这些都是不太重要的, 先把本书本质的内容学会, 后期有时间的话用 typescript 重构下, 先按照作者的思路把本书理一遍.

### 系统: win10

### 全局的包版本, 可以使用下列命令查看

```
npm list -g --depth=0
```

```
+-- grunt@0.4.1
+-- grunt-cli@0.1.9
```

使用下列命令安装即可

```
npm install -g grunt@0.4.1 grunt-cli@0.1.9 phantomjs@1.9.11
```

### 开发依赖包版本

将下面代码拷贝到 package.json, 然后使用 npm install 或者 yarn 即可

```
{
  "name": "my-own-angularjs",
  "version": "0.1.0",
  "license": "MIT",
  "devDependencies": {
    "browserify": "^13.0.0",
    "grunt-contrib-jshint": "2.1.0",
    "grunt-contrib-testem": "0.5.22",
    "jasmine-core": "^2.3.4",
    "jshint": "^2.8.0",
    "karma": "^0.13.15",
    "karma-browserify": "^5.0.4",
    "karma-jasmine": "^0.3.6",
    "karma-jshint-preprocessor": "0.0.6",
    "karma-phantomjs-launcher": "^1.0.0",
    "phantomjs-prebuilt": "^2.1.7",
    "sinon": "^1.17.2",
    "uglifyjs": "^2.4.10",
    "watchify": "^3.7.0"
  },
  "dependencies": {
    "grunt": "0.4.1",
    "jquery": "^2.1.4",
    "lodash": "4.17.14"
  },
  "scripts": {
    "lint": "jshint src test",
    "test": "karma start",
    "build": "browserify src/bootstrap.js > myangular.js",
    "build:minified": "browserify src/bootstrap.js | uglifyjs -mc > myangular.min.js"
  }
}
```

### [问题一: 运行 grunt testem:run:unit 命令行报 fatal error: spawn ENOENT](https://github.com/teropa/build-your-own-angularjs/issues/88)

解决: 根据路径找到以下文件,

```
node_modules/testem/lib folder, open browser_launcher.js
```

在 120 行, 将 phantomjs 的参数替换为

```
{
    name: 'PhantomJS',
    exe: 'phantomjs.cmd',
    args: buildPhantomJsArgs,
    supported: findableByWhere
}
```

#### [问题二]: ReferenceError: \_ is not defined

已经在 gruntfile.js 中加入了下面两行, 还是报错

```
'node_modules/lodash/index.js',
'node_modules/jquery/dist/jquery.js',
```

奇怪的是\$, 也就是 jquery 是成功引入的, index.js 最终引入的是 lodash.js

```
module.exports = require(./lodash)
```

查看了下 chrome 控制台, 实际上加载的只有 index.js, 而并没有将 lodash.js 加载进来, 因此将 index.js 改为 lodash.js 就可以了

```
'node_modules/lodash/lodash.js',
```
