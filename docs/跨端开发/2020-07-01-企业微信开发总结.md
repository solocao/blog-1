---
title: 企业微信开发第三方应用开发总结
tags:
  - javascript
date: 2020-07-01
permalink: 2020-07-01-请设置英文名
---

## 前言

因业务需要, 需要将我们的系统与企业微信进行对接, 折腾了好一阵, 总算告一段落, 总结起来就两个字: 麻烦

- 开发工具: 烂, 不能使用移动端模式, 不能设置 debugger, 一设置就整个企业微信卡死
- 移动端应用居然不给我选择移动端适配?
- 配置麻烦, 尤其是每次修改之后都要进行重新安装(针对我们的业务), 简直是噩梦!!

## 概念理清

官方的开发需知一定要认真读, 理清基本的概念

1. 企业内部应用和第三方应用
2. 上线和上架

## 快速开始

作为一个前端, 如何准备哪些东西, 方便快速开始自己的项目呢?

除了看官方文档的[快速入门](https://work.weixin.qq.com/api/doc/90001/90142/90595), 这里总结了下流程,

### 创建一个企业微信账户

你所在企业作为第三方应用服务商开发应用, 开发完成需要另外一个企业作为使用方使用你的应用, 为了方便测试, 最好的方法是

以你的账号申请一个企业, 用来安装应用进行测试, 最好创建两个, 一个作为 dev 和 staging 环境, 另外一个 production 环境用

### 创建应用

需要你所在企业的企业管理员扫码登录[企业微信服务商后台](https://open.work.weixin.qq.com/wwopen/developer#/index), 在应用管理那里选择-> 创建项目, 之后在应用主页设置各种配置信息

### 可信域名与内网穿透

由于企业微信的第三方 H5 应用需要配置可信域名, 而本地开发地址显然是无法通过企业微信的域名校验的, 解决的方法是使用`内网穿透`, 原理感兴趣可以自行搜索,简单而言就是可以把你的`本地localhost的服务映射到公网的地址`, 以花生壳为例,会自动分配一个域名给你, `xxxxxxx.oicp.vip`, 配置好穿透之后, 将对应的域名填上去就好了.

### 设置各种回调

这步需要后端人员的配合, 只有这步走完之后才能够进行测试

### 本地开发与安装调试

#### 安装

当前端项目初始化完成, 后端回调配置 ok 之后, 就可以尝试安装了, 具体看[文档](https://work.weixin.qq.com/api/doc/90001/90142/90595)

安装完成之后使用你的测试企业, 进入应用管理, 点开相关的应用, 进行配置, 比如可见范围设置所有开发人员可见

#### 调试

企业微信内部可以启用开发者模式

- mac: ctrl + command + shift + D

然后右键点击-> 审查元素即可

但是有几点坑的地方:

1. 别加 debugger, 会直接卡死
2. 无法使用移动端模拟器, 如 iphone6

### 接入授权

因为我们是 H5 应用, 需要走网页授权拿到用户的身份信息, 参考[网页授权登录](https://work.weixin.qq.com/api/doc/90001/90143/91118)

### 接入 sdk

签名会比较麻烦, 主要是后端处理

## 总结

走完上面几步, 基本的开发步骤就算走完了, 接下来是真正的需求实现, 期间也遇到不少坑, 想到再补吧
