<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>underscore源码学习笔记(二)几个helper函数 | 逍遥的前端笔记</title>
    <meta name="description" content="一枚前端菜鸟的成长日记">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.69d5b92f.css" as="style"><link rel="preload" href="/blog/assets/js/app.1011c72d.js" as="script"><link rel="preload" href="/blog/assets/js/2.3955396c.js" as="script"><link rel="preload" href="/blog/assets/js/77.a2385630.js" as="script"><link rel="preload" href="/blog/assets/js/4.ecddb2a0.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.cd932cf8.js"><link rel="prefetch" href="/blog/assets/js/11.d7ff2d2b.js"><link rel="prefetch" href="/blog/assets/js/12.ead75992.js"><link rel="prefetch" href="/blog/assets/js/13.574509c6.js"><link rel="prefetch" href="/blog/assets/js/14.d9bf14a6.js"><link rel="prefetch" href="/blog/assets/js/15.890994e2.js"><link rel="prefetch" href="/blog/assets/js/16.efd16665.js"><link rel="prefetch" href="/blog/assets/js/17.636bec56.js"><link rel="prefetch" href="/blog/assets/js/18.6085d822.js"><link rel="prefetch" href="/blog/assets/js/19.51972a51.js"><link rel="prefetch" href="/blog/assets/js/20.8d0fdf3b.js"><link rel="prefetch" href="/blog/assets/js/21.b419bb6f.js"><link rel="prefetch" href="/blog/assets/js/22.2fbf524e.js"><link rel="prefetch" href="/blog/assets/js/23.b56d10f4.js"><link rel="prefetch" href="/blog/assets/js/24.2d3b2c73.js"><link rel="prefetch" href="/blog/assets/js/25.121c7134.js"><link rel="prefetch" href="/blog/assets/js/26.dafc95cb.js"><link rel="prefetch" href="/blog/assets/js/27.a4ebb31f.js"><link rel="prefetch" href="/blog/assets/js/28.a48fe245.js"><link rel="prefetch" href="/blog/assets/js/29.6653271e.js"><link rel="prefetch" href="/blog/assets/js/3.015225f6.js"><link rel="prefetch" href="/blog/assets/js/30.dbcaad1d.js"><link rel="prefetch" href="/blog/assets/js/31.6ff1741c.js"><link rel="prefetch" href="/blog/assets/js/32.538ba58f.js"><link rel="prefetch" href="/blog/assets/js/33.d4ad2f7f.js"><link rel="prefetch" href="/blog/assets/js/34.d9d1aa4b.js"><link rel="prefetch" href="/blog/assets/js/35.73dfde2a.js"><link rel="prefetch" href="/blog/assets/js/36.9842a106.js"><link rel="prefetch" href="/blog/assets/js/37.20d44174.js"><link rel="prefetch" href="/blog/assets/js/38.4c58f464.js"><link rel="prefetch" href="/blog/assets/js/39.9c23675c.js"><link rel="prefetch" href="/blog/assets/js/40.5521df18.js"><link rel="prefetch" href="/blog/assets/js/41.f790e99e.js"><link rel="prefetch" href="/blog/assets/js/42.1c905843.js"><link rel="prefetch" href="/blog/assets/js/43.fb2c948d.js"><link rel="prefetch" href="/blog/assets/js/44.70bf3b13.js"><link rel="prefetch" href="/blog/assets/js/45.215fd68b.js"><link rel="prefetch" href="/blog/assets/js/46.ff4a918c.js"><link rel="prefetch" href="/blog/assets/js/47.a42faff6.js"><link rel="prefetch" href="/blog/assets/js/48.051e1fd5.js"><link rel="prefetch" href="/blog/assets/js/49.3c3320da.js"><link rel="prefetch" href="/blog/assets/js/5.aaf58c1d.js"><link rel="prefetch" href="/blog/assets/js/50.b54e927d.js"><link rel="prefetch" href="/blog/assets/js/51.455c85de.js"><link rel="prefetch" href="/blog/assets/js/52.4dcb1df6.js"><link rel="prefetch" href="/blog/assets/js/53.b8bac18b.js"><link rel="prefetch" href="/blog/assets/js/54.d28b4885.js"><link rel="prefetch" href="/blog/assets/js/55.958b0c7a.js"><link rel="prefetch" href="/blog/assets/js/56.48497061.js"><link rel="prefetch" href="/blog/assets/js/57.89471e06.js"><link rel="prefetch" href="/blog/assets/js/58.98e763ad.js"><link rel="prefetch" href="/blog/assets/js/59.61c096e0.js"><link rel="prefetch" href="/blog/assets/js/6.60963b88.js"><link rel="prefetch" href="/blog/assets/js/60.e99d475e.js"><link rel="prefetch" href="/blog/assets/js/61.734178eb.js"><link rel="prefetch" href="/blog/assets/js/62.4df4723f.js"><link rel="prefetch" href="/blog/assets/js/63.29132aaa.js"><link rel="prefetch" href="/blog/assets/js/64.8f5dfa92.js"><link rel="prefetch" href="/blog/assets/js/65.b9371697.js"><link rel="prefetch" href="/blog/assets/js/66.1befb39e.js"><link rel="prefetch" href="/blog/assets/js/67.686736ba.js"><link rel="prefetch" href="/blog/assets/js/68.a6f6e8c5.js"><link rel="prefetch" href="/blog/assets/js/69.29137180.js"><link rel="prefetch" href="/blog/assets/js/7.2405aa00.js"><link rel="prefetch" href="/blog/assets/js/70.242ac9ef.js"><link rel="prefetch" href="/blog/assets/js/71.ab1c77b4.js"><link rel="prefetch" href="/blog/assets/js/72.319d1705.js"><link rel="prefetch" href="/blog/assets/js/73.ee22656a.js"><link rel="prefetch" href="/blog/assets/js/74.a85e5bc8.js"><link rel="prefetch" href="/blog/assets/js/75.6e66ccb5.js"><link rel="prefetch" href="/blog/assets/js/76.37065a3e.js"><link rel="prefetch" href="/blog/assets/js/78.6da0a9b0.js"><link rel="prefetch" href="/blog/assets/js/79.c28c225b.js"><link rel="prefetch" href="/blog/assets/js/8.51afdea2.js"><link rel="prefetch" href="/blog/assets/js/80.fce25e46.js"><link rel="prefetch" href="/blog/assets/js/81.f86e2321.js"><link rel="prefetch" href="/blog/assets/js/82.4331d6a6.js"><link rel="prefetch" href="/blog/assets/js/83.ac05ef57.js"><link rel="prefetch" href="/blog/assets/js/84.ebd1a266.js"><link rel="prefetch" href="/blog/assets/js/85.c3ff988b.js"><link rel="prefetch" href="/blog/assets/js/86.89b092e5.js"><link rel="prefetch" href="/blog/assets/js/87.1af08461.js"><link rel="prefetch" href="/blog/assets/js/88.e72e1a8c.js"><link rel="prefetch" href="/blog/assets/js/89.be8bc4ca.js"><link rel="prefetch" href="/blog/assets/js/9.ada81e33.js"><link rel="prefetch" href="/blog/assets/js/90.2948c9d6.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.69d5b92f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">逍遥的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-10-javascript-inheritance-1/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-05-css-specificity/" class="nav-link"> HTML/CSS</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-09-13-leetcode-4-median-of-two-sorted-arrays/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架工具" class="dropdown-title"><span class="title">框架工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-01-react-props-children/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-07-13-build-your-own-angular-0-project-setup/" class="nav-link">AngularJS</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-28-underscore-analysis-1/" class="nav-link">Underscore</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-05-28-how-does-vue-cli-work/" class="nav-link">工具使用</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-24-async-function-Unexpected-identifier/" class="nav-link">踩坑汇总</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-05-30-just-do-it/" class="nav-link">杂谈</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-25-rethinking-object-oriented/" class="nav-link">编程范式&amp;&amp;设计模式</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-10-javascript-inheritance-1/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-05-css-specificity/" class="nav-link"> HTML/CSS</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-09-13-leetcode-4-median-of-two-sorted-arrays/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架工具" class="dropdown-title"><span class="title">框架工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-01-react-props-children/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-07-13-build-your-own-angular-0-project-setup/" class="nav-link">AngularJS</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-28-underscore-analysis-1/" class="nav-link">Underscore</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-05-28-how-does-vue-cli-work/" class="nav-link">工具使用</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/2019-06-24-async-function-Unexpected-identifier/" class="nav-link">踩坑汇总</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-05-30-just-do-it/" class="nav-link">杂谈</a></li><li class="dropdown-item"><!----> <a href="/blog/2019-06-25-rethinking-object-oriented/" class="nav-link">编程范式&amp;&amp;设计模式</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>AngularJS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/2019-07-13-build-your-own-angular-1-scope/" class="sidebar-link">实现angluar手记[一]scope和digest</a></li><li><a href="/blog/2019-07-13-build-your-own-angular-0-project-setup/" class="sidebar-link">实现angluar手记[零]项目初始化</a></li><li><a href="/blog/2019-07-15-build-your-own-angular-2-scope-inheritance/" class="sidebar-link">实现angluar手记[二]scope继承</a></li><li><a href="/blog/2019-07-16-build-your-own-angular-literal-expressions/" class="sidebar-link">实现angluar[手记五]编译字面量表达式</a></li><li><a href="/blog/2019-07-16-build-your-own-angular-events/" class="sidebar-link">实现angluar手记[四]事件系统</a></li><li><a href="/blog/2019-07-17-build-your-own-angular-property-lookup/" class="sidebar-link">实现angluar手记[六]属性查找和函数调用</a></li><li><a href="/blog/2019-07-20-build-your-own-angular-operator-expression/" class="sidebar-link">实现angluar手记[七]操作符表达式</a></li><li><a href="/blog/2019-07-20-build-your-own-angular-cp9-expressions-and-watches/" class="sidebar-link">实现angluar手记[九]表达式与watcher结合</a></li><li><a href="/blog/2019-07-20-build-your-own-angular-cp8-filters/" class="sidebar-link">实现angluar手记[八]过滤器</a></li><li><a href="/blog/2019-07-25-build-your-own-angular-cp10-module-injection/" class="sidebar-link">实现angluar手记[十]模块与依赖注入</a></li><li><a href="/blog/2019-07-28-a-quick-intro-to-dependency-injection/" class="sidebar-link">(译)浅谈依赖注入</a></li><li><a href="/blog/2019-07-29-a-simple-di-framework/" class="sidebar-link">实现一个简易的依赖注入框架</a></li><li><a href="/blog/2019-07-30-angular-tutorial/" class="sidebar-link">angularJS入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/2019-06-01-react-props-children/" class="sidebar-link">学习之理解children</a></li><li><a href="/blog/2019-07-13-build-a-simple-redux/" class="sidebar-link">实现一个简易的redux</a></li><li><a href="/blog/2019-10-23-react-dnd-with-hooks/" class="sidebar-link">使用React实现拖拽组件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>underscore</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/2019-06-28-underscore-analysis-1/" class="sidebar-link">underscore源码学习笔记(一)如何读underscore源码</a></li><li><a href="/blog/2019-06-28-underscore-analysis-3-initialization/" class="sidebar-link">underscore源码学习笔记(三)初始化以及两种调用方式</a></li><li><a href="/blog/2019-06-28-underscore-analysis-2-some-helper-functions/" class="active sidebar-link">underscore源码学习笔记(二)几个helper函数</a></li><li><a href="/blog/2019-06-28-underscore-analysis-5-array-related-method/" class="sidebar-link">underscore源码学习笔记(五)Array相关的方法</a></li><li><a href="/blog/2019-06-28-underscore-analysis-6-implement-bind/" class="sidebar-link">underscore源码学习笔记(六)实现bind,call, apply</a></li><li><a href="/blog/2019-06-28-underscore-analysis-4-collection-related-method/" class="sidebar-link">underscore源码学习笔记(四)collction相关方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具使用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/2019-05-28-how-does-vue-cli-work/" class="sidebar-link">vue-cli等脚手架工具是如何跑起来的</a></li><li><a href="/blog/2019-05-29-implement-a-cli-tool/" class="sidebar-link">实现一个cli工具</a></li><li><a href="/blog/2019-06-30-implement-a-simple-wbpack/" class="sidebar-link">实现一个简易webpack</a></li><li><a href="/blog/2019-07-12-better-commit/" class="sidebar-link">代码提交规范</a></li><li><a href="/blog/2019-07-13-what-is-a-javascript-test/" class="sidebar-link">实现一个简易的javascript测试框架</a></li><li><a href="/blog/2019-09-17-vscode-tricks/" class="sidebar-link">vscode插件以及使用技巧(持续更新)</a></li><li><a href="/blog/2019-10-07-refactoring-nested-condition-statement/" class="sidebar-link">重构手法之使用卫语句移除嵌套条件语句</a></li><li><a href="/blog/2019-10-29-markdown-with-vscode/" class="sidebar-link">在vscode上进行markdown写作</a></li><li><a href="/blog/2019-11-25-build-your-website-with-vuepress/" class="sidebar-link">使用vuepress搭建静态网站</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="上一结构我们使用到了几个-helper-函数-但是由于篇幅所致-我们集中精力在主要的函数上-这一节-我们来深入探讨一下这些函数"><a href="#上一结构我们使用到了几个-helper-函数-但是由于篇幅所致-我们集中精力在主要的函数上-这一节-我们来深入探讨一下这些函数" class="header-anchor">#</a> 上一结构我们使用到了几个 helper 函数,但是由于篇幅所致,我们集中精力在主要的函数上,这一节,我们来深入探讨一下这些函数</h4> <h4 id="一-isarraylike"><a href="#一-isarraylike" class="header-anchor">#</a> 一. isArrayLike()</h4> <p>我们都知道 js 中一切皆对象(array 当然也是),其中有一类特殊的对象,它们和数组一样带有 length 属性的并且可以通过索引值获取元素的对象.但是却不能用一些数组的方法，如 push,pop 等。比如我们常用的 arguments 就是 Array-Like Objects 的一种.</p> <p>underscore 中提供了一种检测是否为类数组的方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">shallowProperty</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token punctuation">:</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token constant">MAX_ARRAY_INDEX</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> getLength <span class="token operator">=</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token string">&quot;length&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">isArrayLike</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">collection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> <span class="token function">getLength</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> length <span class="token operator">==</span> <span class="token string">&quot;number&quot;</span> <span class="token operator">&amp;&amp;</span> length <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> length <span class="token operator">&lt;=</span> <span class="token constant">MAX_ARRAY_INDEX</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>源码简单明了,这里的 shallowProperty 使用了高阶函数和闭包的概念,接受一个 key 值,返回一个用户接受对象参数,获取对象 key 值的方法,比如</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> getAge <span class="token operator">=</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Allen <span class="token operator">=</span> <span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token function">getAge</span><span class="token punctuation">(</span>Allen<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>获取属性之后,检测 length 是否存在以及是否存在于某个合理的区间,这里的上界就是 MAX_ARRAY_INDEX, 关于这个值,我搜索后发现这样一段话:</p> <blockquote><p>The maximum length until &quot;it gets sluggish&quot; is totally dependent on your target machine and your actual code, so you'll need to test on that (those) platform(s) to see what is acceptable.However, the maximum length of an array according to the ECMA-262 5th Edition specification is bound by an unsigned 32-bit integer due to the ToUint32 abstract operation, so the longest possible array could have 232-1 = 4,294,967,295 = 4.29 billion elements.</p></blockquote> <p>也就是根据 ES5 的规范,最大的数组长度应该是 2^32 ,至于作者为什么选择了, 2^53 - 1 这个值,本人暂时还没有探索出来,希望了解的同行批评指教</p> <p>好了,了解什么是类数组之后,我们来看一下另外一个常见的问题: 如何将一个类数组转化为数组?网上大概有这几种思路</p> <p><strong>1.Array.prototype.slice.call</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">F</span><span class="token punctuation">(</span><span class="token string">&quot;allen&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[&quot;allen&quot;, 18]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>2.也可以是使用[]代替 Array.prototype,但是由于新建了一个数组,性能肯定是差些的.</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">F</span><span class="token punctuation">(</span><span class="token string">&quot;allen&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[&quot;allen&quot;, 18]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>3. ES6 的 Array.From 方法(Array.From 还有高级用法,有兴趣可以去 MDN 上查看)</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">F</span><span class="token punctuation">(</span><span class="token string">&quot;allen&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[&quot;allen&quot;, 18]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="4"><li><strong>_.toArray(list)作者使用了正则表达式进行匹配</strong></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> reStrSymbol <span class="token operator">=</span> <span class="token regex">/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g</span><span class="token punctuation">;</span>
<span class="token comment">// Safely create a real, live array from anything iterable.</span>
_<span class="token punctuation">.</span><span class="token function-variable function">toArray</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isString</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Keep surrogate pair characters together</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reStrSymbol<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArrayLike</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> _<span class="token punctuation">.</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="二-isobject-判断参数是否为对象-返回布尔值-对象包含但不限于-array-function-number-date"><a href="#二-isobject-判断参数是否为对象-返回布尔值-对象包含但不限于-array-function-number-date" class="header-anchor">#</a> 二. _.isObject: 判断参数是否为对象,返回布尔值,对象包含但不限于 Array, Function, Number, Date...</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code>_<span class="token punctuation">.</span><span class="token function-variable function">isObject</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">return</span> type <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">||</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="三-判断具体的引用数据类型"><a href="#三-判断具体的引用数据类型" class="header-anchor">#</a> 三. 判断具体的引用数据类型</h4> <p>判断具体引用数据类型最好的方法就是调用 Object.prototype.toString.call</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ObjProto <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
<span class="token punctuation">(</span>toString <span class="token operator">=</span> ObjProto<span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">,</span>
  _<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;Arguments&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Function&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;String&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Number&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Date&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;RegExp&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Symbol&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Map&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;WeakMap&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;Set&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;WeakSet&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _<span class="token punctuation">[</span><span class="token string">&quot;is&quot;</span> <span class="token operator">+</span> name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;[object &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

_<span class="token punctuation">.</span><span class="token function">isDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;[object Date]&quot;</span>
_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;[object Array]&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="四-keys"><a href="#四-keys" class="header-anchor">#</a> 四_.keys:</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>_<span class="token punctuation">.</span><span class="token function-variable function">keys</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nativeKeys<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">nativeKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ES6中新增了Object.keys()</span>
  <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//循环遍历属性,逐个添加到返回的数组中</span>
  <span class="token comment">// Ahem, IE &lt; 9.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hasEnumBug<span class="token punctuation">)</span> <span class="token function">collectNonEnumProps</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> keys<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//IE9以下有bug</span>
  <span class="token keyword">return</span> keys<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对于 for...in 循环,MDN 上是这样解释的: for in 语句用于迭代对象的可枚举的,非 symbol 属性(ES6 新增)</p> <blockquote><p>The for...in statement iterates over all non-Symbol, enumerable properties of an object.</p></blockquote> <p>对于各操作符的属性,<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Enumerability_and_ownership_of_properties" target="_blank" rel="noopener noreferrer">MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上有张图总结得很好
<img src="https://img-blog.csdnimg.cn/20181204115209755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3podWFueWVtYW5vbmc=,size_16,color_FFFFFF,t_70" alt="emunerable">
IE9 以下使用 for..in 会导致某些 key 无法被正确拿到.因此 underscore 做了处理</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ObjProto <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token comment">//ie低版本得到的true</span>
<span class="token keyword">var</span> hasEnumBug <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">{</span> toString<span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">propertyIsEnumerable</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//IE中无法被枚举的属性列表</span>
<span class="token keyword">var</span> nonEnumerableProps <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;isPrototypeof&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;toString&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;propertyIsEnumerable&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;hasOwnProperty&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;toLocalString&quot;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//给keys添加本该枚举的属性</span>
<span class="token keyword">function</span> <span class="token function">collectNonEnumProps</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//上述数组长度</span>
  <span class="token keyword">var</span> nonEnumIdx <span class="token operator">=</span> nonEnumerableProps<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">var</span> constructor <span class="token operator">=</span> obj<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>

  <span class="token comment">//obj的原型</span>
  <span class="token keyword">var</span> proto <span class="token operator">=</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFunction</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token operator">||</span> ObjProto<span class="token punctuation">;</span>

  <span class="token comment">//单独处理constructor</span>
  <span class="token keyword">var</span> prop <span class="token operator">=</span> <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">//如果对象有constructor属性但keys数组中没有，就添加进来</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>_<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">)</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>nonEnumIdx<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prop <span class="token operator">=</span> nonEnumerableProps<span class="token punctuation">[</span>nonEnumIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">!==</span> proto<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>_<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h4 id="五-property-path-propertyof-obj-matcher"><a href="#五-property-path-propertyof-obj-matcher" class="header-anchor">#</a> 五. _.property(path), _.propertyOf(obj),_.matcher</h4> <p>_.property 是接受一个具体的属性 path 或者代表查找层级的 path 的数组,返回一个接受对象的函数,当传入的可以为简单的字符串时,调用的是 shallowProperty 方法,去检测其是否具有这个 path,返回值为<strong>布尔值</strong>,当传入的 path 是一个数组的时候,会按照数组元素的顺序进行查找,找到则返回 value 值,找不到则返回 undefined</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> stooge <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'moe'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token string">'moe'</span> <span class="token operator">===</span> _<span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>stooge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span> <span class="token boolean">true</span>`

<span class="token keyword">var</span> stooges <span class="token operator">=</span> <span class="token punctuation">{</span>moe<span class="token punctuation">:</span> <span class="token punctuation">{</span>fears<span class="token punctuation">:</span> <span class="token punctuation">{</span>worst<span class="token punctuation">:</span> <span class="token string">'Spiders'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> curly<span class="token punctuation">:</span> <span class="token punctuation">{</span>fears<span class="token punctuation">:</span> <span class="token punctuation">{</span>worst<span class="token punctuation">:</span> <span class="token string">'Moe'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> curlysWorstFear <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'curly'</span><span class="token punctuation">,</span> <span class="token string">'fears'</span><span class="token punctuation">,</span> <span class="token string">'worst'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//相当于stooges.curly.fears.worst</span>
<span class="token function">curlysWorstFear</span><span class="token punctuation">(</span>stooges<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;Moe&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>_.propertyOf 刚好相反,接受一个对象,返回一个接受 key 的函数,返回 value 值</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> stooge <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'moe'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
_<span class="token punctuation">.</span><span class="token function">propertyOf</span><span class="token punctuation">(</span>stooge<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span> <span class="token string">'moe'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Returns a function that will return the specified property of any passed-in object
Inverse of _.property. Takes an object and returns a function which will return the value of a provided property.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">deepGet</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> path<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
    obj <span class="token operator">=</span> obj<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> length <span class="token operator">?</span> obj <span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

_<span class="token punctuation">.</span><span class="token function-variable function">property</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">deepGet</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>参考:
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Enumerability_and_ownership_of_properties</p> <p>本文最早发布于<a href="https://blog.csdn.net/zhuanyemanong/article/details/84785246" target="_blank" rel="noopener noreferrer">CSDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2019-11-25 01:36:28</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/2019-06-28-underscore-analysis-3-initialization/" class="prev">underscore源码学习笔记(三)初始化以及两种调用方式</a></span> <span class="next"><a href="/blog/2019-06-28-underscore-analysis-5-array-related-method/">underscore源码学习笔记(五)Array相关的方法</a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="my-loader center" style="display:none;" data-v-45632a08><div class="my-loader-circle" data-v-45632a08></div></div><div class="my-popup" style="display:none;" data-v-3414bdeb><div class="my-popup-container" data-v-3414bdeb><div class="my-popup-exit" data-v-3414bdeb></div> <img src="" alt data-v-3414bdeb></div></div><!----><!----><div></div></div></div>
    <script src="/blog/assets/js/app.1011c72d.js" defer></script><script src="/blog/assets/js/2.3955396c.js" defer></script><script src="/blog/assets/js/77.a2385630.js" defer></script><script src="/blog/assets/js/4.ecddb2a0.js" defer></script>
  </body>
</html>
